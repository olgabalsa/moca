# moca
A tool for computing mock RVs induced by exoplanets

<p align="center">
<img src="https://github.com/olgabalsa/mocha/assets/47603865/8fb9ef02-b9c8-4089-a6ee-e36e2283f0f3" width="350" />

## Warning
This documentation is under construction. We are working on provide more information on the code and its usage. If you have any question or suggestion, please contact me: obalsalobre@cab.inta-csic.es.
  
  
## Installation

Just download this folder or clone it to your computer.

## Usage

Call it from the terminal as:
```python
python run_moca.py -st M2 -np 2 -p 4.5 12.3 -mp 3.5 7.1 -star MyStar -nrv 10 -erv 3.5 -cad 12 -dir 'path/outputs/'
```
Moca will simulate all the parameters you don't want to provide. The list of inputs are the following:

|           Input           | Name                                  | Description                                                                                                                          |      Units      | Examples                   | Default  | When/Why is needed                                                                                                                                  |
|:-------------------------:|:-------------------------------------:|:------------------------------------------------------------------------------------------------------------------------------------:|:-------------:|:--------------------------:|:--------:|:-----------------------------------------------------------------------------------------------------------------------------------------------------|
|      Star information                                                                                                                                                        |
|           -star           | Star name                             | Name of the star to be resolved with SIMBAD                                                                                          | -               | -star TOI-969              | Unknown  | To consider the target's visibility [alternative to its coordinates, -ra and -dec]                                                                  |
|            -ra            | Right ascension                       | RA of the star in demical format                                                                                                     | deg             | -ra 7.6758                 | None     | To consider the target's visibility [alternative to its SIMBAD name, -s]                                                                            |
|            -dec           | Declination                           | DEC of the star in demical format                                                                                                    | deg             | -dec 2.0989                | None     | To consider the target's visibility [alternative to its SIMBAD name, -s]                                                                            |
|            -ms            | Stellar mass                          | Stellar mass                                                                                                                         | Solar           | -ms 0.73                   | 0.646    | To compute the RV semi-amplitude if it is unknown, otherwise, provide it with -k. Stellar mass can be computed from the spectral type with -st      |
|            -st            | Spectral type                         | Spectral type (only main sequence)                                                                                                   | -               | -st K4                     | K7       | To infer the stellar mass (from bibliographic relations) and therefore compute the RV semi-amplitude in case it is unknown                          |
|            -act           | Activity level                        | Gaussian Process amplitude for the red noise (see recommended values below$^1$)                                                      | m/s             | -act 1.5                   | 0        | To consider red noise using a Gaussian Process with a quasi-periodic kernel                                                                         |
|            -pr            | Rotational period                     | Stellar rotational period for the red noise (see recommended values below$^2$)                                                       | days            | -pr 24.6                   | None     | To consider red noise using a Gaussian Process with a quasi-periodic kernel                                                                         |
|            -pm            | Period of the magnetic cycle          | Stellar magnetic cycle period for the red noise (see recommended values below$^3$)                                                   | days            | -pm 100                    | None     | To consider red noise using a Gaussian Process with a quasi-periodic kernel                                                                         |
|   Planetary information   |                                       |                                                                                                                                      |                 |                            |          |                                                                                                                                                     |
| -np                       | Number of planets                     | Number of planets around the star                                                                                                    | -               | -np 2                      | 1        | -                                                                                                                                                   |
| -p                        | Orbital period                        | Orbital period(s) of the planet(s)$^4$                                                                                               | days            | -p 1.8 1700.0              |          | -                                                                                                                                                   |
| -t0                       | Transiting time                       | Transiting time(s) of the planet(s)$^4$                                                                                              | BJD             | -t0 2459248.3 nan          |          | -                                                                                                                                                   |
| -e                        | Eccentricity                          | Orbital eccentricity(/ies)$^4$                                                                                                       | -               | -e nan 0.6                 |          | -                                                                                                                                                   |
| -w                        | Argument of periastron                | Argument(s) of periastron$^4$                                                                                                        | deg             | -w nan 209                 |          | -                                                                                                                                                   |
| -i                        | Orbital inclination                   | Orbital inclination(s)$^4$                                                                                                           | deg             | -i 86.8 nan                |          | -                                                                                                                                                   |
| -k                        | RV semi-amplitude                     | RV semi-amplitude(s)$^4$                                                                                                             | m/s             | -k 4.5 3.1                 |          | To compute the RV signature directly from this semi-amplitude if known. Otherwise, it is computed using the stellar mass and the orbital parameters |
| -mp                       | Planetary mass                        | Planetary mass(es)$^4$                                                                                                               | specified in -u | -mp 9.1 3590               |          | To compute the RV semi-amplitude if it is not provided                                                                                              |
| -rp                       | Planetary radius                      | Planetary radius/radii$^4$                                                                                                           | specified in -u | -rp 2.8 nan                |          | To obtain the planetary mass from empirical relations (Chen & Kipping, 2016) to later compute the RV semi-amplitude                                 |
| -erp                      | Uncertainty of the planetary radius   | Uncertainty of the planetary radius/radii$^4$                                                                                        | specified in -u | -erp 0.1 nan               | 0.2 x Rp | To obtain the planetary mass from empirical relations (Chen & Kipping, 2016) to later compute the RV semi-amplitude                                 |
| -u                        | Units                                 | Units for the planetary mass and radius ("e" for Earth, and "j" for Jupiter)                                                         | -               | -u j                       | e        | -                                                                                                                                                   |
| Observational information |                                       |                                                                                                                                      |                 |                            |          |                                                                                                                                                     |
| -erv                      | RV uncertainty                        | Median of the RV uncertainties to be simulated                                                                                       | m/s             | -erv 3.5                   |          | To mimic the sensitivity of a given instrument                                                                                                      |
| -jit                      | RV jitter                             | Median of the white noise                                                                                                            | m/s             | -jit 4.5                   |          | -                                                                                                                                                   |
| -obs                      | Observatory                           | Name of the observatory                                                                                                              | -               | -obs "La Silla"            | None     | To compute target's visibility                                                                                                                      |
| -wl                       | Weather loss                          | Boolean to consider weather loss$^5$                                                                                                 | -               | --wl                       | False    | -                                                                                                                                                   |
| -cwlp                     | Customized weather loss percentage    | Customized weather loss percentage (homogeneous over the year)                                                                       | -               | -cwlp 10                   | *        | -                                                                                                                                                   |
| -id                       | Initial date                          | Date to start the observations in "YYYY-MM-DD" format                                                                                | -               | -id 2024-10-28             |          | To compute the target's visibility if observatory and the target's name/coordinates are provided                                                    |
| -ed                       | End date                              | Date to end the observations in "YYYY-MM-DD" format                                                                                  | -               | -ed 2025-06-30             |          | To compute the target's visibility if observatory and the target's name/coordinates are provided                                                    |
| -ma                       | Minumum altitude                      | Minumum altitude to observe the target                                                                                               | deg             | -ma 65                     | 30       | To compute the target's visibility if observatory and the target's name/coordinates are provided                                                    |
| Strategy information      |                                       |                                                                                                                                      |                 |                            |          |                                                                                                                                                     |
| -sn                       | Strategy name                         | Strategy name. Options are "mon" for Monotonic, "blo" for Blocks, and "sch" for Scheduled                                            | -               | -sn blo                    | mon      | To costumize the observing dates of your schedule by following a strategy                                                                           |
| -nm                       | Maximum number of RVs                 | Maximum total number of RV measurements to be simulated. Note that if weather loss is activated, less than nm RVs will be simulated  | -               | -nm 80                     | 30       | -                                                                                                                                                   |
| -nn                       | Number of RVs per night               | Number of RV measurements to be simulated per night                                                                                  | -               | -nn 3                      | 1        | -                                                                                                                                                   |
| -mdhn                     | Minimum difference of hours per night | Minimum time in hours between consecutive observations happening in the same night                                                   | hours           | -mhdn 2.5                  |          | -                                                                                                                                                   |
| -cad                      | Cadence                               | Median cadence to observe the target                                                                                                 | days            | -cad 3                     |          | -                                                                                                                                                   |
| -nb                       | Number of blocks                      | Maximum number of blocks                                                                                                             | -               | -nb 10                     |          | -                                                                                                                                                   |
| -db                       | Duration of the blocks                | Duration of the observing blocks                                                                                                     | days            | -db 4                      |          | -                                                                                                                                                   |
| -gb                       | Gap between blocks                    | Gap between blocks (from the last observation until the first one of a new block)                                                    | days            | -gb 20                     |          | -                                                                                                                                                   |
| -jd                       | File path of scheduled JD             | Path to the ASCII/CSV/TXT file with the BJDs to observe the target                                                                   | -               | -jd "mydir/myfile.csv"     |          | -                                                                                                                                                   |
| Outputs                   |                                       |                                                                                                                                      |                 |                            |          |                                                                                                                                                     |
| -dir                      | Output path                           | Output directory path                                                                                                                | -               | -dir "mydir/moca_results/" |          | -                                                                                                                                                   |

For more information, do ```python run_moca.py --help``` to see all the options.
